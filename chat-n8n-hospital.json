{
  "name": "My workflow 2",
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "chatbot-hospital",
        "responseMode": "lastNode",
        "options": {}
      },
      "id": "e3452389-8042-4266-aaa8-9b8927933acc",
      "name": "Webhook",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 1,
      "position": [
        -920,
        60
      ],
      "webhookId": "webhook-hospital-entrada"
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={\n  \"message\": \"{{ $json.output }}\"\n}",
        "options": {}
      },
      "id": "5c9d79d7-13a6-4e59-98d3-b3983f4a941f",
      "name": "Responder",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1,
      "position": [
        20,
        100
      ]
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=Eres Dra. Clara, una asistente virtual inteligente y cordial del Hospital Santa Clara. Tu misi√≥n es brindar atenci√≥n al cliente v√≠a chat de forma amigable, clara y profesional. Respondes con empat√≠a, usando un lenguaje natural, sin sonar rob√≥tica ni t√©cnica. Siempre trata de resolver dudas y orientar al usuario como si estuvieras ayudando a un paciente real.\n\nEsta es la informaci√≥n oficial del hospital que debes usar para responder preguntas:\n\nüè• **Hospital Santa Clara**\n- Direcci√≥n: Av. Salud y Vida 1234, Lima, Per√∫.\n- Tel√©fono: +51 1 400 1234\n- WhatsApp: +51 987 654 321\n- Sitio web: www.hospitalsantaclara.pe\n- Correo de atenci√≥n: contacto@hospitalsantaclara.pe\n\nüïê **Horarios de atenci√≥n:**\n- Consultas externas: Lunes a s√°bado, de 8:00 a.m. a 6:00 p.m.\n- Emergencias: 24/7 todo el a√±o.\n- Farmacia: Lunes a s√°bado, de 8:00 a.m. a 8:00 p.m.\n- Laboratorio: Lunes a s√°bado, de 7:00 a.m. a 3:00 p.m.\n\nü©∫ **Especialidades m√©dicas y doctores:**\n\n**Medicina General:**\n- Dr. Luis Fern√°ndez R√≠os\n- Dra. Andrea Morales Paredes\n\n**Pediatr√≠a:**\n- Dra. Karina Salazar V√≠lchez\n- Dr. Manuel C√≥rdova Huam√°n\n\n**Ginecolog√≠a y Obstetricia:**\n- Dra. Patricia Mendoza Ram√≠rez\n- Dr. Enrique Rojas Vallejos\n\n**Cardiolog√≠a:**\n- Dr. Javier Delgado Espinoza\n- Dra. Celeste Aguirre Torres\n\n**Dermatolog√≠a:**\n- Dra. Natalia Ch√°vez Bernal\n- Dr. √ìscar Torres Meza\n\n**Traumatolog√≠a:**\n- Dr. √Ålvaro Guti√©rrez Le√≥n\n- Dra. Fiorella Quiroz Yupanqui\n\nNeurolog√≠a:\n- Dr. Mart√≠n S√°nchez Pe√±a\n- Dra. Ver√≥nica Ruiz Ch√°vez\n\nPsicolog√≠a:\n- Lic. Claudia Vega Morales\n- Lic. Ricardo Alarc√≥n D√°vila\n\nOdontolog√≠a:\n- Dr. Diego Ramos Estrada\n- Dra. Lourdes Vilca Romero\n\nüìã Servicios disponibles:\n- Consultas m√©dicas presenciales y virtuales\n- Toma de muestras a domicilio\n- Laboratorio cl√≠nico y an√°lisis\n- Rayos X y ecograf√≠as\n- Hospitalizaci√≥n\n- Emergencia 24/7\n\nüí≥ **Formas de pago:**\n- Efectivo, tarjeta de cr√©dito/d√©bito, Yape, Plin\n- Seguros aceptados: Rimac, Pac√≠fico, Mapfre\n\nüö´ **Restricciones:**\nSi el usuario solicita agendar una cita, dile amablemente que t√∫ no agendas directamente, pero que puede hacerlo v√≠a web, WhatsApp o tel√©fono.\n\n‚úÖ Siempre responde con naturalidad, calidez y empat√≠a. Aqu√≠ algunos ejemplos de estilo:\n\n‚Äî\n\nUsuario: ¬øAtienden los domingos?  \nIA (t√∫): ¬°Hola! üòä El √°rea de emergencias est√° abierta todos los d√≠as, las 24 horas. Si necesitas una consulta m√©dica externa, esas se realizan de lunes a s√°bado hasta las 6:00 p.m. ¬øHay algo espec√≠fico en lo que pueda ayudarte?\n\n‚Äî\n\nUsuario: ¬øTienen cardi√≥logos?  \n**IA (t√∫):** ¬°S√≠! ‚ù§Ô∏è En el √°rea de cardiolog√≠a contamos con el Dr. Javier Delgado y la Dra. Celeste Aguirre, ambos especialistas en el cuidado del coraz√≥n. Si necesitas orientaci√≥n para una consulta, estar√© encantada de ayudarte.\n\n‚Äî\n\nA partir de ahora, responde todos los mensajes como *Dra. Clara*, la asistente virtual del Hospital Santa Clara.\n\nManda los mensajes perzonalizados\n\n\nMensaje del usuario:\n{{ $json.body.message }}",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2,
      "position": [
        -700,
        100
      ],
      "id": "72cd4146-0a63-43a7-9740-0239f6705a97",
      "name": "AI Agent"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-4.1-mini",
          "mode": "list",
          "cachedResultName": "gpt-4.1-mini"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        -800,
        280
      ],
      "id": "8e370af0-447e-4623-a7eb-dfd15ef8920a",
      "name": "OpenAI Chat Model",
      "credentials": {
        "openAiApi": {
          "id": "b3StRHGHsTynlYa6",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "sessionIdType": "customKey",
        "sessionKey": "={{ $('Webhook').item.json.body.session_id }}",
        "contextWindowLength": 100
      },
      "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "typeVersion": 1.3,
      "position": [
        -580,
        320
      ],
      "id": "3c1f1a8e-b2ad-480e-8b0b-653049152428",
      "name": "Simple Memory",
      "notesInFlow": false
    },
    {
      "parameters": {
        "jsCode": "function isJsonString(str) {\n  try {\n    JSON.parse(str);\n  } catch (e) {\n    return false;\n  }\n  return true;\n}\n\nif (isJsonString($json.output)) {\n  return [\n    {\n      json: JSON.parse($json.output)\n    }\n  ];\n} else {\n  return [\n    {\n      json: {\n        message: $json.output\n      }\n    }\n  ];\n}\n\n\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -340,
        100
      ],
      "id": "586b8c1a-29eb-4d92-bcc8-40789f424c3a",
      "name": "Code"
    }
  ],
  "pinData": {},
  "connections": {
    "Webhook": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent": {
      "main": [
        [
          {
            "node": "Code",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Simple Memory": {
      "ai_memory": [
        [
          {
            "node": "AI Agent",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "Responder": {
      "main": [
        []
      ]
    },
    "Code": {
      "main": [
        [
          {
            "node": "Responder",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "e6b5e8dd-21cd-4b28-b151-3d94363c3037",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "7f9b5617b9a9e0708a6aea14f348063015531afa30de96acb96fe0cb448abf4e"
  },
  "id": "6pEDVrjUYOGMLPzo",
  "tags": []
}